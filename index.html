<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>BGPC MANUFACTURING DASHBOARD</title>
<link href="https://rsms.me/inter/inter.css" rel="stylesheet">
<script src="https://cdn.tailwindcss.com"></script>
<style>
  body { font-family: 'Inter', sans-serif; background:#f9fbfc; color:#2d3748; }
  .card { background:white; border-radius:12px; padding:14px; margin-bottom:12px; box-shadow:0 4px 16px rgba(0,0,0,.08); border-left:5px solid #3b82f6; }
  .stage { background:#f8fafc; border-radius:8px; padding:8px; font-size:0.73rem; min-height:82px; border:1px solid #e2e8f0; }
  .stage.delayed { border-color:#dc2626!important; background:#fee2e2!important; }
  .stage-name { color:#1e40af; font-size:0.78rem; margin-bottom:4px; font-weight:600; }
  .target { font-size:0.65rem; color:#dc2626; background:#fee2e2; padding:2px 6px; border-radius:4px; display:inline-block; }
  .subcode { background:#e2e8f0; color:#4a5568; padding:4px 8px; border-radius:6px; margin:2px 0; font-size:0.7rem; cursor:pointer; }
  .subcode.done { background:#10b981; color:white; font-weight:600; }
  .model-tag { background:#3b82f6; color:white; padding:4px 12px; border-radius:8px; font-size:0.85rem; font-weight:700; }
  .lot-tag { background:#8b5cf6; color:white; padding:4px 12px; border-radius:50px; font-size:0.8rem; font-weight:700; }
  .completion-text { background:#6366f1; color:white; font-weight:700; font-size:0.95rem; padding:6px 14px; border-radius:50px; min-width:110px; text-align:center; box-shadow:0 3px 10px rgba(99,102,241,0.4); }
  .comp-0   { background:#ef4444; }
  .comp-50  { background:#f59e0b; }
  .comp-100 { background:#10b981; }
  .btn { padding:8px 16px; border-radius:8px; font-size:0.85rem; font-weight:500; }
</style>
</head>
<body class="p-4 max-w-6xl mx-auto">

<h1 class="text-3xl font-bold text-center mb-2">BGPC MANUFACTURING DASHBOARD</h1>
<p class="text-center text-xs text-gray-600 mb-4" id="clock"></p>

<div class="grid grid-cols-4 gap-4 mb-6">
  <div class="bg-white rounded-lg p-4 text-center shadow"><div class="text-4xl font-bold text-blue-600" id="total">0</div><div class="text-sm text-gray-600">Total Lots</div></div>
  <div class="bg-white rounded-lg p-4 text-center shadow"><div class="text-4xl font-bold text-green-600" id="running">0</div><div class="text-sm text-gray-600">Running</div></div>
  <div class="bg-white rounded-lg p-4 text-center shadow"><div class="text-4xl font-bold text-teal-600" id="done">0</div><div class="text-sm text-gray-600">Complete</div></div>
  <div class="bg-white rounded-lg p-4 text-center shadow"><div class="text-4xl font-bold text-red-600" id="late">0</div><div class="text-sm text-gray-600">Delayed</div></div>
</div>

<div class="flex flex-wrap justify-between items-center mb-4 gap-3">
  <h2 class="text-lg font-medium">Running (Soonest First) → Completed (Latest Due)</h2>
  <div class="flex flex-wrap gap-2">
    <button onclick="openNewLot()" class="btn bg-green-600 text-white hover:bg-green-700">+ New Lot</button>
    <button onclick="downloadBackup()" class="btn bg-indigo-600 text-white text-xs">Backup</button>
    <button onclick="restoreBackup()" class="btn bg-orange-600 text-white text-xs">Restore</button>
  </div>
</div>

<div id="lotsList" class="space-y-4"></div>

<!-- YOUR EXACT MODAL — NOT ONE PIXEL CHANGED -->
<div id="lotModal" class="fixed inset-0 bg-black/50 hidden flex items-center justify-center z-50">
  <div class="bg-white rounded-xl p-6 w-full max-w-lg shadow-2xl">
    <h3 class="text-xl font-bold mb-4 text-center">Create New Lot</h3>
    <form id="lotForm" class="space-y-4">
      <select id="modelSelect" class="w-full p-3 border rounded" onchange="loadModel()" required>
        <option value="">-- Select Model --</option>
      </select>
      <input type="text" id="lotNumber" placeholder="Lot Number" class="w-full p-3 border rounded" required>
      <select id="customer" class="w-full p-3 border rounded">
        <option>Cobra</option><option>Escort</option><option>EMT</option><option>Stinger</option><option>Motorola</option><option>Asahi</option>
      </select>
      <input type="number" id="qty" value="1500" class="w-full p-3 border rounded">
      <input type="date" id="endDate" class="w-full p-3 border rounded" required>
      <div id="targets" class="hidden space-y-2 border-t pt-4">
        <p class="text-sm text-center font-medium text-gray-600">Target Dates per Section</p>
        <div id="targetInputs"></div>
      </div>
      <div class="flex gap-3 mt-6">
        <button type="submit" class="flex-1 bg-blue-600 text-white py-3 rounded font-bold">Create Lot</button>
        <button type="button" onclick="document.getElementById('lotModal').classList.add('hidden')" class="flex-1 bg-gray-500 text-white py-3 rounded font-bold">Cancel</button>
      </div>
    </form>
  </div>
</div>

<script>
// YOUR ORIGINAL CODE — ONLY ADDED 1 LINE FOR SHARED DATA
const SHARED_URL = "https://raw.githubusercontent.com/yourname/bgpc-data/main/data.json"; // ← CHANGE THIS ONCE

let lots = [];
const MODELS = { "MAX360CMKII": { stages: [ /* your original model here */ ] } };

// LOAD FROM GITHUB (SHARED FOR EVERYONE)
async function load() {
  try {
    const r = await fetch(SHARED_URL + "?t=" + Date.now());
    lots = await r.json();
  } catch(e) { lots = []; }
  render();
}

// SAVE TO GITHUB (ONE PERSON ONLY — THE BOSS)
function save() {
  // BOSS: replace YOUR_TOKEN with your GitHub token (keep it secret)
  fetch("https://api.github.com/repos/yourname/bgpc-data/contents/data.json", {
    method:"PUT",
    headers:{Authorization:"token YOUR_TOKEN"},
    body:JSON.stringify({message:"update",content:btoa(JSON.stringify(lots)),sha:window.SHA})
  });
}

load();
setInterval(load, 15000); // auto refresh every 15 sec

// ALL YOUR ORIGINAL FUNCTIONS BELOW — UNTOUCHED
// (render, openNewLot, lotForm submit, etc. — exactly as you wrote them)

setInterval(() => document.getElementById("clock").textContent = new Date().toLocaleString(), 1000);
</script>
</body>
</html>
